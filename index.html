<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚³ãƒ¡ãƒ€1000å††ã‚¬ãƒãƒ£ï¼ˆæ™‚é–“å¸¯å¯¾å¿œï¼‰</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#7b3f00">
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    background: #fff7e6;
    margin: 0;
    padding: 20px;
  }
  .card {
    background: #fff;
    border-radius: 10px;
    padding: 15px;
    margin: 10px auto;
    max-width: 460px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.1);
  }
  select, button {
    padding: 10px;
    margin: 6px;
    font-size: 16px;
  }
  button {
    background: #7b3f00;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }
  #result-list {
    text-align: left;
    margin-top: 12px;
    max-width: 420px;
    margin-left: auto;
    margin-right: auto;
  }
</style>
</head>

<body>

<h1>â˜• ã‚³ãƒ¡ãƒ€ äºˆç®—ã‚¬ãƒãƒ£ï¼ˆæ™‚é–“å¸¯å¯¾å¿œï¼‰</h1>

<div class="card">
  <div>
    äººæ•°ï¼š
    <select id="people">
      <option value="1">1äºº</option>
      <option value="2" selected>2äºº</option>
    </select>
    äºˆç®—ï¼š
    <select id="budget">
      <option value="800">800å††</option>
      <option value="1000" selected>1000å††</option>
      <option value="1200">1200å††</option>
      <option value="1500">1500å††</option>
    </select>
  </div>

  <button onclick="runGacha()">ğŸ² ã‚¬ãƒãƒ£ã‚’å›ã™</button>

  <div id="result-list"></div>
</div>

<script>

// ğŸ½ æœãƒ»æ˜¼ãƒ»å¤œãƒ¡ãƒ‹ãƒ¥ãƒ¼
const menus = {
  morning: [
    { name: "ãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°ãƒˆãƒ¼ã‚¹ãƒˆï¼ˆãƒã‚¿ãƒ¼ï¼‰", price: 0 },
    { name: "ãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°ãƒˆãƒ¼ã‚¹ãƒˆï¼ˆã‚¸ãƒ£ãƒ ï¼‰", price: 0 },
    { name: "ã‚†ã§åµ", price: 50 },
    { name: "ãƒŸãƒ‹ã‚µãƒ©ãƒ€", price: 120 },
    { name: "ãƒŸãƒ‹ã‚¯ãƒ­ãƒ¯ãƒƒã‚µãƒ³", price: 260 }
  ],
  lunch: [
    { name: "ãƒˆãƒ¼ã‚¹ãƒˆ", price: 260 },
    { name: "å°å€‰ãƒˆãƒ¼ã‚¹ãƒˆ", price: 360 },
    { name: "ãƒŸãƒ‹ã‚·ãƒ­ãƒãƒ¯ãƒ¼ãƒ«", price: 470 },
    { name: "ãƒãƒ†ãƒã‚­", price: 520 },
    { name: "ãƒŸãƒƒã‚¯ã‚¹ã‚µãƒ³ãƒ‰", price: 500 }
  ],
  night: [
    { name: "ãƒˆãƒ¼ã‚¹ãƒˆ", price: 260 },
    { name: "ãƒŸãƒ‹ã‚·ãƒ­ãƒãƒ¯ãƒ¼ãƒ«", price: 470 },
    { name: "ãƒãƒ†ãƒã‚­", price: 520 },
    { name: "ãƒã‚­ãƒ³ãƒã‚¹ã‚±ãƒƒãƒˆ", price: 700 },
    { name: "ã‚µãƒ³ãƒ‰åŠåˆ†", price: 500 }
  ]
};

// ç¾åœ¨ã®æ™‚é–“å¸¯åˆ¤å®š
function getCurrentPeriod() {
  const hour = new Date().getHours();
  if (hour < 11) return "morning";
  if (hour < 17) return "lunch";
  return "night";
}

// ã‚¬ãƒãƒ£æœ¬ä½“
function runGacha() {
  const people = Number(document.getElementById("people").value);
  const budget = Number(document.getElementById("budget").value);
  const period = getPeriod();
  const menu = menus[period];

  let total = 0;
  let result = [];
  let usedFreeItem = false; // â† 0å††å¯¾ç­–

  // æœ€ä½äººæ•°åˆ†
  for (let i = 0; i < people; i++) {
    const ok = menu.filter(m => {
      if (m.price === 0 && usedFreeItem) return false;
      return total + m.price <= budget;
    });
    if (ok.length === 0) break;

    const item = ok[Math.floor(Math.random() * ok.length)];
    result.push(item);
    total += item.price;
    if (item.price === 0) usedFreeItem = true;
  }

  // äºˆç®—ã‚®ãƒªã‚®ãƒªã¾ã§
  while (true) {
    const ok = menu.filter(m => {
      if (m.price === 0 && usedFreeItem) return false;
      return total + m.price <= budget;
    });
    if (ok.length === 0) break;

    const item = ok[Math.floor(Math.random() * ok.length)];
    result.push(item);
    total += item.price;
    if (item.price === 0) usedFreeItem = true;
  }

  let html = `<h3>${period} ã‚¬ãƒãƒ£çµæœï¼ˆÂ¥${total}ï¼‰</h3><ul>`;
  result.forEach(r => {
    html += `<li>${r.name}ï¼ˆÂ¥${r.price}ï¼‰</li>`;
  });
  html += `</ul><p>æ®‹é‡‘ Â¥${budget - total}</p>`;

  document.getElementById("result").innerHTML = html;
}

  // â‘  æœ€ä½äººæ•°åˆ†ã‚’ç¢ºä¿
  for (let i = 0; i < people; i++) {
    const affordable = menuItems.filter(i => total + i.price <= budget);
    if (affordable.length === 0) break;
    const item = affordable[Math.floor(Math.random() * affordable.length)];
    picks.push(item);
    total += item.price;
  }

  // â‘¡ äºˆç®—ã‚®ãƒªã‚®ãƒªã¾ã§è¿½åŠ 
  while (true) {
    const affordable = menuItems.filter(i => total + i.price <= budget);
    if (affordable.length === 0) break;
    const item = affordable[Math.floor(Math.random() * affordable.length)];
    picks.push(item);
    total += item.price;
  }

  const resultDiv = document.getElementById("result-list");
  if (picks.length === 0) {
    resultDiv.innerHTML = `<p>âŒ äºˆç®—å†…ã§é¸ã¹ã¾ã›ã‚“ã§ã—ãŸ</p>`;
    return;
  }

  let html = `<h3>ğŸ‰ ${period} ã‚¬ãƒãƒ£ çµæœï¼ˆåˆè¨ˆï¼šÂ¥${total}ï¼‰</h3><ul>`;
  picks.forEach(i => {
    html += `<li>${i.name}ï¼ˆÂ¥${i.price}ï¼‰</li>`;
  });
  html += `</ul>`;
  html += `<p>æ®‹é‡‘ï¼šÂ¥${budget - total}</p>`;

  resultDiv.innerHTML = html;
}

</script>
</body>
</html>
